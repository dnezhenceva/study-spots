<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>–ö–∞–±–∏–Ω–µ—Ç ‚Äî Study Spots</title>
  <style>
    :root{
      --text:#0b1020; --muted:#51607a;
      --card: rgba(255,255,255,0.60); --stroke: rgba(15,23,42,0.10);
      --shadow: 0 18px 55px rgba(2,6,23,0.14);
      --primary1:#1d4ed8; --primary2:#0ea5e9;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 600px at 12% 10%, rgba(37,99,235,0.22), transparent 60%),
        radial-gradient(900px 600px at 92% 25%, rgba(251,113,133,0.18), transparent 55%),
        radial-gradient(1000px 700px at 55% 105%, rgba(14,165,233,0.18), transparent 55%),
        linear-gradient(180deg, #ffffff 0%, #f3f7ff 40%, #f6f2ff 100%);
      min-height:100vh;
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1080px;margin:0 auto;padding:18px}
    .top{
      display:flex;align-items:center;justify-content:space-between;
      gap:12px;flex-wrap:wrap;padding:12px 0;
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:44px;height:44px;border-radius:14px;
      background: radial-gradient(circle at 30% 30%, #60a5fa 0%, #2563eb 38%, #0ea5e9 72%, #f472b6 100%);
      box-shadow: 0 18px 40px rgba(29,78,216,0.25);
    }
    .btn{
      border:1px solid rgba(15,23,42,0.10);
      background: rgba(255,255,255,0.65);
      padding:10px 12px;border-radius:14px;cursor:pointer;
      display:inline-flex;align-items:center;gap:8px;
      backdrop-filter: blur(12px);
    }
    .btn.primary{
      border:none;color:#fff;
      background: linear-gradient(135deg,var(--primary1),var(--primary2));
      box-shadow: 0 14px 34px rgba(29,78,216,0.20);
    }
    .pill{
      display:inline-flex;align-items:center;gap:8px;
      border: 1px solid rgba(15,23,42,0.10);
      background: rgba(255,255,255,0.60);
      padding: 8px 10px;
      border-radius: 999px;
      font-size: 12.5px;
      color: var(--muted);
      backdrop-filter: blur(12px);
    }
    .card{
      border: 1px solid rgba(255,255,255,0.55);
      background: rgba(255,255,255,0.60);
      border-radius: 22px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      padding: 16px;
    }
    .grid{
      margin-top:14px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
    }
    .h1{margin:0;font-size:22px}
    .muted{color:var(--muted);line-height:1.4}
    .stat{
      margin-top:12px;
      display:flex;gap:10px;flex-wrap:wrap;
    }
    .tile{
      flex:1;
      min-width: 220px;
      border: 1px solid rgba(15,23,42,0.10);
      background: rgba(255,255,255,0.55);
      border-radius: 18px;
      padding: 12px;
    }
    .tile b{font-size:18px}
    @media(max-width:920px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo"></div>
        <div>
          <b>Study Spots</b>
          <div class="pill" style="margin-top:6px">–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</div>
        </div>
      </div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
        <a class="btn" href="/study-spots/public/map.html">‚Üê –ù–∞ –∫–∞—Ä—Ç—É</a>
        <button class="btn" id="logout">–í—ã–π—Ç–∏</button>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="h1">–ü—Ä–æ—Ñ–∏–ª—å</div>
        <div class="muted" id="info" style="margin-top:10px">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</div>

        <div class="stat" id="stats" style="display:none">
          <div class="tile">
            <div class="muted">Check-in –∑–∞ 90 –º–∏–Ω—É—Ç</div>
            <b id="activeNow">‚Äî</b>
          </div>
          <div class="tile">
            <div class="muted">–í—Å–µ–≥–æ –ø–æ—Å–µ—â–µ–Ω–∏–π (–¥–µ–º–æ)</div>
            <b id="totalVisits">‚Äî</b>
          </div>
        </div>

        <div class="muted" style="margin-top:12px">
          –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å ‚Äú–º–æ–∏ –æ—Ç–∑—ã–≤—ã‚Äù –∏ ‚Äú–∏—Å—Ç–æ—Ä–∏—é –ø–æ—Å–µ—â–µ–Ω–∏–π‚Äù. –î–ª—è –∫—É—Ä—Å–æ–≤–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–æ—Ñ–∏–ª—è + –≤—ã—Ö–æ–¥–∞.
        </div>
      </div>

      <div class="card">
        <div class="h1">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</div>
        <div class="muted" style="margin-top:10px">–ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –∫–∞—Ä—Ç—É –∏ –∏—Å–ø–æ–ª—å–∑—É–π ‚Äú–Ø –∑–¥–µ—Å—å‚Äù, —á—Ç–æ–±—ã –ø–æ–≤–ª–∏—è—Ç—å –Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç—å –º–µ—Å—Ç.</div>
        <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
          <a class="btn primary" href="/study-spots/public/map.html#recommend">‚ú® –õ—É—á—à–∏–µ –º–µ—Å—Ç–∞ —Å–µ–π—á–∞—Å</a>
          <a class="btn" href="/study-spots/public/map.html#mapArea">üó∫Ô∏è –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç—É</a>
          <a class="btn" href="/study-spots/public/auth.html?mode=reg">‚ûï –°–æ–∑–¥–∞—Ç—å –≤—Ç–æ—Ä–æ–π –∞–∫–∫–∞—É–Ω—Ç</a>
        </div>
      </div>
    </div>
  </div>

<script>
async function loadMe(){
  const r = await fetch('/study-spots/api/me.php', {cache:'no-store'});
  const j = await r.json();
  if (!j.user){
    location.href = '/study-spots/public/auth.html?mode=login';
    return;
  }

  document.getElementById('info').innerHTML =
    `<div class="pill">üë§ ${j.user.Username}</div>
     <div class="muted" style="margin-top:10px">
       –¢—ã –≤–æ—à–ª–∞ –≤ –∞–∫–∫–∞—É–Ω—Ç. –¢–µ–ø–µ—Ä—å –∫–Ω–æ–ø–∫–∏ ‚Äú–Ø –∑–¥–µ—Å—å / –Ø –≤—ã—à–ª–∞‚Äù –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ –∫–∞—Ä—Ç–µ –∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –º–µ—Å—Ç–∞.
     </div>`;

  document.getElementById('stats').style.display = 'flex';
  document.getElementById('activeNow').textContent = '‚úî –¥–æ—Å—Ç—É–ø–Ω–æ';
  document.getElementById('totalVisits').textContent = '‚Äî';
}

document.getElementById('logout').onclick = async ()=>{
  await fetch('/study-spots/api/logout.php', {method:'POST'});
  location.href = '/study-spots/public/map.html';
};

loadMe();
</script>
</body>
</html>
